<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Falcon Prospect Pro - Facontech</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Seus estilos CSS permanecem os mesmos */
        :root {
            --primary: #2c3e50;
            --secondary: #3498db;
            --accent: #e74c3c;
            --success: #2ecc71;
            --warning: #f39c12;
            --light: #ecf0f1;
            --dark: #2c3e50;
            --grey: #95a5a6;
            --shadow: rgba(44, 62, 80, 0.2);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 15px 40px var(--shadow);
            overflow: hidden;
            animation: fadeIn 0.8s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 25px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 10px;
        }
        
        .logo i {
            font-size: 2.5rem;
            color: #fff;
        }
        
        .logo-text {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        
        .company {
            font-size: 1rem;
            font-weight: 400;
            opacity: 0.9;
        }
        
        .app-name {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1;
        }
        
        header h1 {
            font-size: 1.5rem;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        header p {
            opacity: 0.9;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .form-container {
            padding: 30px;
        }
        
        .form-section {
            margin-bottom: 30px;
            padding-bottom: 25px;
            border-bottom: 1px solid #eaeaea;
            animation: slideIn 0.5s ease;
        }
        
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        
        .section-title {
            font-size: 1.3rem;
            margin-bottom: 20px;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            background: var(--secondary);
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .required::after {
            content: '*';
            color: var(--accent);
            margin-left: 4px;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: var(--transition);
            background-color: #fafafa;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: var(--secondary);
            background-color: white;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
        }
        
        .error-message {
            color: var(--accent);
            font-size: 0.85rem;
            margin-top: 6px;
            display: none;
            animation: shake 0.4s ease;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        
        .datalist-container {
            position: relative;
        }
        
        .datalist-options {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--secondary);
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .datalist-option {
            padding: 12px 16px;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .datalist-option:hover {
            background-color: #f0f8ff;
        }
        
        .dynamic-fields {
            background-color: #f9fafc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
            border-left: 4px solid var(--secondary);
            animation: fadeIn 0.5s ease;
        }
        
        .field-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            align-items: flex-end;
        }
        
        .field-group > div {
            flex: 1;
        }
        
        .btn {
            padding: 14px 22px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--secondary), #2980b9);
            color: white;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);
        }
        
        .btn-secondary {
            background-color: #f5f5f5;
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background-color: #e0e0e0;
        }
        
        .btn-sm {
            padding: 10px 14px;
            font-size: 0.9rem;
        }
        
        .btn-add {
            background-color: white;
            border: 2px dashed var(--secondary);
            color: var(--secondary);
        }
        
        .btn-add:hover {
            background-color: #f0f8ff;
        }
        
        .btn-remove {
            background-color: #ffebee;
            color: var(--accent);
        }
        
        .btn-remove:hover {
            background-color: #ffcdd2;
        }
        
        .keywords-input-container {
            margin-top: 15px;
        }
        
        .keywords-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        
        .keyword-tag {
            background: var(--secondary);
            color: white;
            border-radius: 20px;
            padding: 8px 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
        }
        
        .keyword-tag .remove {
            cursor: pointer;
            font-size: 0.8rem;
        }
        
        .search-type-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 15px;
        }
        
        .search-type-item {
            background: #f5f7ff;
            border: 2px solid #e0e7ff;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
        }
        
        .search-type-item:hover {
            background: #e0e7ff;
            transform: translateY(-2px);
        }
        
        .search-type-item.selected {
            background: var(--secondary);
            color: white;
            border-color: var(--secondary);
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .search-type-item i {
            font-size: 2rem;
            margin-bottom: 15px;
            display: block;
        }
        
        .search-type-item h3 {
            margin-bottom: 10px;
            font-size: 1.2rem;
        }
        
        .search-type-item p {
            font-size: 0.9rem;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .search-type-item .details {
            font-size: 0.8rem;
            opacity: 0.8;
            background: rgba(255, 255, 255, 0.2);
            padding: 8px;
            border-radius: 6px;
            margin-top: 10px;
        }
        
        .actions {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 1px solid #eaeaea;
        }
        
        .success-message {
            display: none;
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
        
        .help-text {
            font-size: 0.9rem;
            color: var(--grey);
            margin-top: 6px;
        }
        
        .price-input {
            position: relative;
        }
        
        .price-input::before {
            content: "R$";
            position: absolute;
            left: 14px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--dark);
            font-weight: 500;
        }
        
        .price-input input {
            padding-left: 40px;
        }
        
        @media (max-width: 768px) {
            .field-group {
                flex-direction: column;
                gap: 10px;
            }
            
            .search-type-container {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 8px;
            color: var(--grey);
            cursor: help;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 250px;
            background-color: var(--dark);
            color: white;
            text-align: center;
            border-radius: 6px;
            padding: 10px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
            font-weight: normal;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(46, 204, 113, 0); }
            100% { box-shadow: 0 0 0 0 rgba(46, 204, 113, 0); }
        }
        
        .section-help {
            font-size: 0.95rem;
            color: var(--grey);
            margin-bottom: 15px;
            padding: 10px 15px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border-left: 3px solid var(--secondary);
        }
        
        .no-remove {
            pointer-events: none;
            opacity: 0.5;
        }
        
        .partial-report-note {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 12px;
            margin-top: 15px;
            font-size: 0.9rem;
            color: #856404;
        }
        
        .partial-report-note i {
            margin-right: 8px;
            color: #f39c12;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <i class="fas fa-falcon"></i>
                <div class="logo-text">
                    <span class="company">Facontech</span>
                    <span class="app-name">Falcon Prospect Pro</span>
                </div>
            </div>
            <h1>Configuração de Busca de Prospecção</h1>
            <p>Preencha os critérios para encontrar as melhores oportunidades</p>
        </header>
        
        <div class="form-container">
            <form id="searchConfigForm">
                <div class="form-section">
                    <h2 class="section-title"><i class="fas fa-map-marker-alt"></i> Localização</h2>
                    <div class="section-help">
                        A localização é essencial para direcionar sua busca às regiões de interesse. 
                        <span class="tooltip">
                            <i class="fas fa-question-circle"></i>
                            <span class="tooltiptext">Informe o estado e cidade onde deseja prospectar lojas. Isso ajuda a filtrar resultados por proximidade geográfica.</span>
                        </span>
                    </div>
                    
                    <div class="form-group">
                        <label for="state" class="required">Estado</label>
                        <div class="datalist-container">
                            <input type="text" id="state" name="state" required placeholder="Digite o estado ou selecione" list="statesList" autocomplete="off">
                            <div class="datalist-options" id="stateOptions"></div>
                            <datalist id="statesList"></datalist>
                        </div>
                        <div class="error-message">Por favor, selecione um estado válido do Brasil</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="city" class="required">Cidade/Região</label>
                        <input type="text" id="city" name="city" required placeholder="Ex: Campinas">
                        <div class="error-message">Por favor, informe a cidade ou região</div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h2 class="section-title"><i class="fas fa-tags"></i> Marcas</h2>
                    <div class="section-help">
                        Informe as marcas que deseja prospectar. Você pode adicionar até 3 marcas.
                        <span class="tooltip">
                            <i class="fas fa-question-circle"></i>
                            <span class="tooltiptext">As marcas ajudam a filtrar lojas que trabalham com produtos específicos, direcionando melhor sua prospecção.</span>
                        </span>
                    </div>
                    
                    <div id="brands-container">
                        <div class="form-group">
                            <label for="brand1" class="required">Marca 1</label>
                            <input type="text" id="brand1" name="brands[]" required placeholder="Ex: Nike">
                            <div class="error-message">Por favor, informe pelo menos uma marca</div>
                        </div>
                    </div>
                    
                    <button type="button" id="add-brand" class="btn btn-add btn-sm">
                        <i class="fas fa-plus"></i> Adicionar outra marca
                    </button>
                </div>
                
                <div class="form-section">
                    <h2 class="section-title"><i class="fas fa-shopping-bag"></i> Produtos e Preços</h2>
                    <div class="section-help">
                        Adicione produtos específicos que deseja prospectar. Pelo menos um produto é obrigatório.
                        <span class="tooltip">
                            <i class="fas fa-question-circle"></i>
                            <span class="tooltiptext">Informe produtos específicos e suas faixas de preço para encontrar lojas que trabalham com itens similares. Pelo menos um preço (mínimo ou máximo) deve ser informado para cada produto.</span>
                        </span>
                    </div>
                    
                    <div id="products-container">
                        <div class="dynamic-fields">
                            <div class="form-group">
                                <label for="productName1" class="required">Nome do Produto</label>
                                <input type="text" id="productName1" name="products[0][name]" placeholder="Ex: Camiseta" required>
                                <div class="error-message">Por favor, informe o nome do produto</div>
                            </div>
                            <div class="field-group">
                                <div class="form-group">
                                    <label for="minPrice1">Preço Mínimo (R$)</label>
                                    <div class="price-input">
                                        <input type="text" id="minPrice1" name="products[0][min_price]" placeholder="0,00" inputmode="numeric" class="price-field">
                                    </div>
                                    <div class="error-message">Preço mínimo é obrigatório se o máximo não for preenchido</div>
                                </div>
                                <div class="form-group">
                                    <label for="maxPrice1">Preço Máximo (R$)</label>
                                    <div class="price-input">
                                        <input type="text" id="maxPrice1" name="products[0][max_price]" placeholder="0,00" inputmode="numeric" class="price-field">
                                    </div>
                                    <div class="error-message">Preço máximo é obrigatório se o mínimo não for preenchido</div>
                                </div>
                            </div>
                            <!-- Botão de remover removido para o primeiro produto -->
                        </div>
                    </div>
                    
                    <button type="button" id="add-product" class="btn btn-add">
                        <i class="fas fa-plus"></i> Adicionar produto
                    </button>
                </div>
                
                <div class="form-section">
                    <h2 class="section-title"><i class="fas fa-store"></i> Tipo de Loja</h2>
                    <div class="section-help">
                        Adicione palavras-chave que definem o tipo de loja que deseja prospectar. Pelo menos uma palavra-chave é obrigatória.
                        <span class="tooltip">
                            <i class="fas fa-question-circle"></i>
                            <span class="tooltiptext">Use palavras-chave específicas para descrever o nicho das lojas que você quer prospectar (ex: "moda feminina", "esportes", "luxo"). Essas palavras ajudarão a encontrar estabelecimentos alinhados com seu objetivo.</span>
                        </span>
                    </div>
                    
                    <div class="form-group">
                        <label for="keywordInput" class="required">Palavras-chave</label>
                        <div class="field-group">
                            <input type="text" id="keywordInput" placeholder="Digite uma palavra-chave e pressione Enter">
                            <button type="button" id="add-keyword" class="btn btn-add btn-sm">
                                <i class="fas fa-plus"></i> Adicionar
                            </button>
                        </div>
                        <div class="error-message" id="keywords-error">Por favor, adicione pelo menos uma palavra-chave</div>
                    </div>
                    
                    <div class="keywords-list" id="keywords-list">
                        <!-- Palavras-chave serão adicionadas aqui -->
                    </div>
                    <input type="hidden" id="selected-keywords" name="selectedKeywords">
                </div>
                
                <div class="form-section">
                    <h2 class="section-title"><i class="fas fa-cog"></i> Tipo de Pesquisa</h2>
                    <div class="section-help">
                        Selecione o tipo de pesquisa que deseja realizar.
                        <span class="tooltip">
                            <i class="fas fa-question-circle"></i>
                            <span class="tooltiptext">A pesquisa padrão é mais rápida, enquanto a avançada pode levar até 24h para obter informações através de contato direto com as lojas.</span>
                        </span>
                    </div>
                    
                    <div class="search-type-container" id="search-type-container">
                        <div class="search-type-item" data-type="standard">
                            <i class="fas fa-search"></i>
                            <h3>Pesquisa Padrão</h3>
                            <p>Busca automatizada em redes sociais, Google, imagens, áudios e textos publicados pela loja</p>
                            <div class="details">
                                <i class="fas fa-clock"></i> Resultados em minutos
                            </div>
                        </div>
                        <div class="search-type-item" data-type="advanced">
                            <i class="fas fa-search-plus"></i>
                            <h3>Pesquisa Avançada</h3>
                            <p>Além da busca padrão, nosso agente de IA entra em contato com a loja para obter informações adicionais</p>
                            <div class="details">
                                <i class="fas fa-clock"></i> Pode levar até 24h
                            </div>
                        </div>
                    </div>
                    <input type="hidden" id="selected-search-type" name="searchType" value="standard">
                    
                    <div class="partial-report-note">
                        <i class="fas fa-info-circle"></i>
                        <strong>Relatório Parcial:</strong> Você pode solicitar um relatório parcial a qualquer momento, mesmo durante o processo de pesquisa.
                    </div>
                </div>
                
                <div class="actions">
                    <button type="reset" class="btn btn-secondary">
                        <i class="fas fa-redo"></i> Limpar
                    </button>
                    <button type="submit" class="btn btn-primary pulse">
                        <i class="fas fa-paper-plane"></i> Enviar Configuração
                    </button>
                </div>
                
                <div id="successMessage" class="success-message">
                    <i class="fas fa-check-circle"></i> 
                    <div>
                        <h3>Configuração enviada com sucesso!</h3>
                        <p>Estamos processando sua solicitação de prospecção.</p>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Estados do Brasil
            const estados = [
                "Acre", "Alagoas", "Amapá", "Amazonas", "Bahia", "Ceará", 
                "Distrito Federal", "Espírito Santo", "Goiás", "Maranhão", 
                "Mato Grosso", "Mato Grosso do Sul", "Minas Gerais", "Pará", 
                "Paraíba", "Paraná", "Pernambuco", "Piauí", "Rio de Janeiro", 
                "Rio Grande do Norte", "Rio Grande do Sul", "Rondônia", "Roraima", 
                "Santa Catarina", "São Paulo", "Sergipe", "Tocantins"
            ];
            
            // Preencher datalist com estados
            const statesList = document.getElementById('statesList');
            estados.forEach(estado => {
                const option = document.createElement('option');
                option.value = estado;
                statesList.appendChild(option);
            });
            
            // Configuração do autocomplete para estados
            const stateInput = document.getElementById('state');
            const stateOptions = document.getElementById('stateOptions');
            
            stateInput.addEventListener('input', function() {
                const value = this.value.toLowerCase();
                stateOptions.innerHTML = '';
                
                if (value) {
                    const filteredStates = estados.filter(estado => 
                        estado.toLowerCase().includes(value)
                    );
                    
                    if (filteredStates.length > 0) {
                        stateOptions.style.display = 'block';
                        
                        filteredStates.forEach(estado => {
                            const option = document.createElement('div');
                            option.className = 'datalist-option';
                            option.textContent = estado;
                            option.addEventListener('click', function() {
                                stateInput.value = estado;
                                stateOptions.style.display = 'none';
                            });
                            stateOptions.appendChild(option);
                        });
                    } else {
                        stateOptions.style.display = 'none';
                    }
                } else {
                    stateOptions.style.display = 'none';
                }
            });
            
            stateInput.addEventListener('focus', function() {
                if (stateOptions.children.length > 0) {
                    stateOptions.style.display = 'block';
                }
            });
            
            document.addEventListener('click', function(e) {
                if (!stateInput.contains(e.target) && !stateOptions.contains(e.target)) {
                    stateOptions.style.display = 'none';
                }
            });
            
            // Contadores para marcas e produtos
            let brandCount = 1;
            let productCount = 1;
            
            // Elementos do DOM
            const brandsContainer = document.getElementById('brands-container');
            const addBrandButton = document.getElementById('add-brand');
            const productsContainer = document.getElementById('products-container');
            const addProductButton = document.getElementById('add-product');
            const form = document.getElementById('searchConfigForm');
            const keywordsList = document.getElementById('keywords-list');
            const keywordInput = document.getElementById('keywordInput');
            const addKeywordButton = document.getElementById('add-keyword');
            const selectedKeywordsInput = document.getElementById('selected-keywords');
            const keywordsError = document.getElementById('keywords-error');
            const searchTypeContainer = document.getElementById('search-type-container');
            const selectedSearchTypeInput = document.getElementById('selected-search-type');
            
            // Palavras-chave selecionadas
            let selectedKeywords = [];
            
            // Adicionar palavra-chave
            function addKeyword() {
                const keyword = keywordInput.value.trim();
                
                if (keyword && !selectedKeywords.includes(keyword)) {
                    if (selectedKeywords.length < 5) {
                        selectedKeywords.push(keyword);
                        selectedKeywordsInput.value = selectedKeywords.join(',');
                        
                        const keywordTag = document.createElement('div');
                        keywordTag.className = 'keyword-tag';
                        keywordTag.innerHTML = `
                            ${keyword}
                            <span class="remove" data-keyword="${keyword}">
                                <i class="fas fa-times"></i>
                            </span>
                        `;
                        keywordsList.appendChild(keywordTag);
                        
                        // Adicionar evento de remoção
                        keywordTag.querySelector('.remove').addEventListener('click', function() {
                            const removeKeyword = this.getAttribute('data-keyword');
                            selectedKeywords = selectedKeywords.filter(k => k !== removeKeyword);
                            selectedKeywordsInput.value = selectedKeywords.join(',');
                            keywordsList.removeChild(keywordTag);
                            keywordsError.style.display = 'none';
                        });
                        
                        keywordInput.value = '';
                        keywordsError.style.display = 'none';
                    } else {
                        alert('Você pode adicionar no máximo 5 palavras-chave');
                    }
                }
            }
            
            // Eventos para adicionar palavra-chave
            addKeywordButton.addEventListener('click', addKeyword);
            
            keywordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addKeyword();
                }
            });
            
            // Seleção do tipo de pesquisa
            searchTypeContainer.querySelectorAll('.search-type-item').forEach(item => {
                item.addEventListener('click', function() {
                    searchTypeContainer.querySelectorAll('.search-type-item').forEach(i => {
                        i.classList.remove('selected');
                    });
                    
                    this.classList.add('selected');
                    selectedSearchTypeInput.value = this.getAttribute('data-type');
                });
            });
            
            // Selecionar pesquisa padrão por padrão
            document.querySelector('.search-type-item[data-type="standard"]').classList.add('selected');
            
            // Adicionar marca
            addBrandButton.addEventListener('click', function() {
                if (brandCount < 3) {
                    brandCount++;
                    const newBrand = document.createElement('div');
                    newBrand.className = 'form-group';
                    newBrand.innerHTML = `
                        <div class="field-group">
                            <div>
                                <label for="brand${brandCount}">Marca ${brandCount}</label>
                                <input type="text" id="brand${brandCount}" name="brands[]" placeholder="Ex: Adidas">
                            </div>
                            <button type="button" class="btn btn-remove btn-sm remove-brand">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    brandsContainer.appendChild(newBrand);
                    
                    // Adicionar evento ao botão de remover
                    newBrand.querySelector('.remove-brand').addEventListener('click', function() {
                        brandsContainer.removeChild(newBrand);
                        brandCount--;
                        
                        if (brandCount < 3) {
                            addBrandButton.style.display = 'block';
                        }
                    });
                }
                
                if (brandCount >= 3) {
                    addBrandButton.style.display = 'none';
                }
            });
            
            // Configurar formatação de preço para o produto inicial
            setupPriceFormatting(productsContainer);
            
            // Adicionar produto
            addProductButton.addEventListener('click', function() {
                if (productCount < 3) {
                    productCount++;
                    const newProduct = document.createElement('div');
                    newProduct.className = 'dynamic-fields';
                    newProduct.innerHTML = `
                        <div class="form-group">
                            <label for="productName${productCount}">Nome do Produto</label>
                            <input type="text" id="productName${productCount}" name="products[${productCount}][name]" placeholder="Ex: Camiseta">
                        </div>
                        <div class="field-group">
                            <div class="form-group">
                                <label for="minPrice${productCount}">Preço Mínimo (R$)</label>
                                <div class="price-input">
                                    <input type="text" id="minPrice${productCount}" name="products[${productCount}][min_price]" placeholder="0,00" inputmode="numeric" class="price-field">
                                </div>
                                <div class="error-message">Preço mínimo é obrigatório se o máximo não for preenchido</div>
                            </div>
                            <div class="form-group">
                                <label for="maxPrice${productCount}">Preço Máximo (R$)</label>
                                <div class="price-input">
                                    <input type="text" id="maxPrice${productCount}" name="products[${productCount}][max_price]" placeholder="0,00" inputmode="numeric" class="price-field">
                                </div>
                                <div class="error-message">Preço máximo é obrigatório se o mínimo não for preenchido</div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-remove btn-sm remove-product">
                            <i class="fas fa-trash"></i> Remover Produto
                        </button>
                    `;
                    productsContainer.appendChild(newProduct);
                    
                    // Configurar formatação de preço
                    setupPriceFormatting(newProduct);
                    
                    // Adicionar evento ao botão de remover
                    newProduct.querySelector('.remove-product').addEventListener('click', function() {
                        productsContainer.removeChild(newProduct);
                        productCount--;
                        
                        if (productCount < 3) {
                            addProductButton.style.display = 'block';
                        }
                    });
                }
                
                if (productCount >= 3) {
                    addProductButton.style.display = 'none';
                }
            });
            
            // Formatação de preço
            function setupPriceFormatting(container) {
                const priceFields = container.querySelectorAll('.price-field');
                
                priceFields.forEach(field => {
                    field.addEventListener('input', function(e) {
                        // Remove tudo que não é número
                        let value = this.value.replace(/\D/g, '');
                        
                        // Adiciona zeros à esquerda se necessário
                        while (value.length < 3) {
                            value = '0' + value;
                        }
                        
                        // Formata como valor monetário
                        const formattedValue = (parseInt(value) / 100).toLocaleString('pt-BR', {
                            minimumFractionDigits: 2,
                            maximumFractionDigits: 2
                        });
                        
                        this.value = formattedValue;
                    });
                    
                    field.addEventListener('blur', function() {
                        if (this.value === '0,00') {
                            this.value = '';
                        }
                    });
                });
            }
            
            // Validação do formulário
            form.addEventListener('submit', function(e) {
                e.preventDefault();
                let isValid = true;
                
                // Validar estado
                const stateValue = stateInput.value.trim();
                if (!stateValue || !estados.includes(stateValue)) {
                    isValid = false;
                    stateInput.style.borderColor = '#e74c3c';
                    stateInput.nextElementSibling.style.display = 'block';
                } else {
                    stateInput.style.borderColor = '#e0e0e0';
                    stateInput.nextElementSibling.style.display = 'none';
                }
                
                // Validar cidade
                const cityValue = document.getElementById('city').value.trim();
                if (!cityValue) {
                    isValid = false;
                    document.getElementById('city').style.borderColor = '#e74c3c';
                    document.getElementById('city').nextElementSibling.style.display = 'block';
                } else {
                    document.getElementById('city').style.borderColor = '#e0e0e0';
                    document.getElementById('city').nextElementSibling.style.display = 'none';
                }
                
                // Validar marcas
                const brandInputs = form.querySelectorAll('input[name="brands[]"]');
                let hasBrand = false;
                brandInputs.forEach(input => {
                    if (input.value.trim()) {
                        hasBrand = true;
                        input.style.borderColor = '#e0e0e0';
                        if (input.nextElementSibling && input.nextElementSibling.classList.contains('error-message')) {
                            input.nextElementSibling.style.display = 'none';
                        }
                    } else {
                        isValid = false;
                        input.style.borderColor = '#e74c3c';
                        if (input.nextElementSibling && input.nextElementSibling.classList.contains('error-message')) {
                            input.nextElementSibling.style.display = 'block';
                        }
                    }
                });
                
                // Validar produtos
                const productNames = form.querySelectorAll('input[name^="products"][name$="[name]"]');
                let hasProduct = false;
                
                productNames.forEach(nameInput => {
                    const nameValue = nameInput.value.trim();
                    if (nameValue) {
                        hasProduct = true;
                        nameInput.style.borderColor = '#e0e0e0';
                        if (nameInput.nextElementSibling && nameInput.nextElementSibling.classList.contains('error-message')) {
                            nameInput.nextElementSibling.style.display = 'none';
                        }
                        
                        // Encontrar os campos de preço relacionados
                        const index = nameInput.name.match(/\d+/)[0];
                        const minPrice = document.querySelector(`input[name="products[${index}][min_price]"]`);
                        const maxPrice = document.querySelector(`input[name="products[${index}][max_price]"]`);
                        
                        if (!minPrice.value && !maxPrice.value) {
                            isValid = false;
                            minPrice.style.borderColor = '#e74c3c';
                            maxPrice.style.borderColor = '#e74c3c';
                            if (minPrice.nextElementSibling && minPrice.nextElementSibling.classList.contains('error-message')) {
                                minPrice.nextElementSibling.style.display = 'block';
                            }
                        } else {
                            minPrice.style.borderColor = '#e0e0e0';
                            maxPrice.style.borderColor = '#e0e0e0';
                            if (minPrice.nextElementSibling && minPrice.nextElementSibling.classList.contains('error-message')) {
                                minPrice.nextElementSibling.style.display = 'none';
                            }
                        }
                    } else {
                        // Para produtos adicionais, o nome não é obrigatório
                        // Mas se o nome estiver vazio, ignoramos o produto
                        nameInput.style.borderColor = '#e0e0e0';
                        if (nameInput.nextElementSibling && nameInput.nextElementSibling.classList.contains('error-message')) {
                            nameInput.nextElementSibling.style.display = 'none';
                        }
                    }
                });
                
                // Verificar se pelo menos um produto foi preenchido
                if (!hasProduct) {
                    isValid = false;
                    const firstProductName = document.querySelector('input[name^="products"][name$="[name]"]');
                    if (firstProductName) {
                        firstProductName.style.borderColor = '#e74c3c';
                        if (firstProductName.nextElementSibling && firstProductName.nextElementSibling.classList.contains('error-message')) {
                            firstProductName.nextElementSibling.style.display = 'block';
                        }
                    }
                }
                
                // Validar palavras-chave
                if (selectedKeywords.length === 0) {
                    isValid = false;
                    keywordsError.style.display = 'block';
                } else {
                    keywordsError.style.display = 'none';
                }
                
                // Se o formulário for válido, enviar
                if (isValid) {
                    const successMessage = document.getElementById('successMessage');
                    const submitButton = form.querySelector('button[type="submit"]');
                    
                    submitButton.classList.remove('pulse');
                    submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';
                    submitButton.disabled = true;
                    
                    // Coletar dados do formulário
                    const formData = new FormData(form);
                    const data = Object.fromEntries(formData.entries());
                    
                    // Adicionar palavras-chave selecionadas
                    data.selectedKeywords = selectedKeywords;
                    
                    // URL do webhook do n8n (substitua pela sua URL)
                    const webhookUrl = 'https://facontech.app.n8n.cloud/webhook/4bdd04a8-92c2-4579-840b-5630ec3a7953';
                    
                    // Enviar dados para o webhook do n8n
                    fetch(webhookUrl, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data),
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Erro ao enviar os dados');
                        }
                        return response.json();
                    })
                    .then(result => {
                        // Sucesso no envio
                        successMessage.style.display = 'flex';
                        successMessage.style.gap = '12px';
                        form.reset();
                        
                        // Resetar palavras-chave
                        keywordsList.innerHTML = '';
                        selectedKeywords = [];
                        selectedKeywordsInput.value = '';
                        
                        // Restaurar botão de enviar
                        submitButton.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Configuração';
                        submitButton.disabled = false;
                        submitButton.classList.add('pulse');
                        
                        // Ocultar mensagem de sucesso após 5 segundos
                        setTimeout(() => {
                            successMessage.style.display = 'none';
                        }, 5000);
                    })
                    .catch(error => {
                        console.error('Erro:', error);
                        alert('Ocorreu um erro ao enviar a configuração. Tente novamente.');
                        submitButton.innerHTML = '<i class="fas fa-paper-plane"></i> Enviar Configuração';
                        submitButton.disabled = false;
                        submitButton.classList.add('pulse');
                    });
                } else {
                    // Animar os campos com erro
                    const errorFields = form.querySelectorAll('.error-message:not([style*="none"])');
                    errorFields.forEach(field => {
                        field.parentElement.classList.add('animated', 'shake');
                        setTimeout(() => {
                            field.parentElement.classList.remove('animated', 'shake');
                        }, 1000);
                    });
                }
            });
            
            // Adicionar animação de digitação no título
            const title = document.querySelector('header h1');
            const originalText = title.textContent;
            title.textContent = '';
            let charIndex = 0;
            
            function typeTitle() {
                if (charIndex < originalText.length) {
                    title.textContent += originalText.charAt(charIndex);
                    charIndex++;
                    setTimeout(typeTitle, 50);
                }
            }
            
            setTimeout(typeTitle, 500);
        });
    </script>
</body>
</html>
